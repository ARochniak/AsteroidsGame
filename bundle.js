!function(e){var s={};function t(i){if(s[i])return s[i].exports;var a=s[i]={i:i,l:!1,exports:{}};return e[i].call(a.exports,a,a.exports,t),a.l=!0,a.exports}t.m=e,t.c=s,t.d=function(e,s,i){t.o(e,s)||Object.defineProperty(e,s,{enumerable:!0,get:i})},t.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},t.t=function(e,s){if(1&s&&(e=t(e)),8&s)return e;if(4&s&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(t.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&s&&"string"!=typeof e)for(var a in e)t.d(i,a,function(s){return e[s]}.bind(null,a));return i},t.n=function(e){var s=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(s,"a",s),s},t.o=function(e,s){return Object.prototype.hasOwnProperty.call(e,s)},t.p="",t(t.s=0)}([function(e,s,t){"use strict";t.r(s);class i{constructor(e){this.img=e.img,this.pos=e.pos,this.size=e.size,this.speed="number"==typeof e.speed?e.speed:0,this.frames=e.frames,this.once=e.once,this.gameSize=e.gameSize,this.dir=e.dir||"horizontal",this._index=0}update(e){this._index+=this.speed*e}render(e,s,t){let i;if(this.speed>0){const e=this.frames.length,s=Math.floor(this._index);if(i=this.frames[s%e],this.once&&s>=e)return this.done=!0,void t()}else i=0;let a=this.pos[0],h=this.pos[1];"vertical"==this.dir?h+=i*this.size[1]:a+=i*this.size[0],e.drawImage(this.img,a,h,this.size[0],this.size[1],s.x,s.y,this.gameSize,this.gameSize)}}const a=new class{constructor(e,s){this.model=e,this.view=s,this.lastTime=0,this.view.setCanvas(this.model.sizes),this.model.setAsteroids(this.model.level),this.bindKeyHandlers=this.bindKeyHandlers.bind(this)}bindButtonsTouch(){document.querySelectorAll(".buttons div").forEach(e=>{e.addEventListener("touchstart",this.touchStartHandler.bind(this)),e.addEventListener("touchend",this.touchEndHandler.bind(this))})}bindKeyHandlers(){this.view.bind("keydown",this.keyDownHandler.bind(this)),this.view.bind("keyup",this.keyUpHandler.bind(this))}gameRender(){const e=this.model.asteroids,s=this.model.spaceship,t=this.model.sizes,i=(Date.now()-this.lastTime)/1e3;this.view.drawAll({spaceStation:this.model.spaceStation,spaceship:s,asteroids:e},t,this.model.gameBegin,i),this.checkLose(e,s,t,i).checkWin(s,t),this.model.asteroidsBouncing(i).spaceshipCoordsChange(i),this.lastTime=Date.now(),requestAnimationFrame(this.gameRender.bind(this))}checkIntersection(e,s,t){const i=t.spaceship/2,a=t.asteroid/2,h=Math.abs(e.x+i-s.x-a),n=Math.abs(e.y+i-s.y-a);return i+a>Math.sqrt(h*h+n*n)}checkLose(e,s,t,i){if(!this.model.gameBegin)return this;if(s.destroyed)this.view.drawExplosion(i,s,this.gameEnd.bind(this));else for(let a=0;a<e.length;a++)this.checkIntersection(s,e[a],t)&&(document.removeEventListener("keydown",this.keyDownHandler),document.removeEventListener("keyup",this.keyUpHandler),this.view.drawExplosion(i,s,this.gameEnd.bind(this)),this.model.destroySpaceship());return this}gameEnd(){document.location.reload(),alert("You lose!")}checkWin(e,s){e.x===s.canvas.width-s.spaceship&&e.y===s.canvas.height-s.spaceship&&(setTimeout(()=>alert("You complete the level!"),0),this.model.levelUp())}keyDownHandler(e){if(e.repeat)return;let s;switch(e.keyCode){case 37:s="left";break;case 38:s="up";break;case 39:s="right";break;case 40:s="down"}this.model.moveStarship(s)}keyUpHandler(e){let s;switch(e.keyCode){case 37:s="left";break;case 38:s="up";break;case 39:s="right";break;case 40:s="down"}this.model.stopMovingStarship(s)}touchStartHandler(e){e.preventDefault();const s=e.target.textContent.toLowerCase();console.log(s),this.model.moveStarship(s)}touchEndHandler(e){e.preventDefault();const s=e.target.textContent.toLowerCase();console.log(s),this.model.stopMovingStarship(s)}}(new class{constructor(){this.level=1,this.gameBegin=!1,this.sizes={canvas:{width:.8*window.innerWidth,height:.8*window.innerHeight},asteroid:30,spaceship:60},this.asteroidSpeed=230,this.asteroids=[],this.ssDirection={left:!1,up:!1,right:!1,down:!1},this.spaceship={x:0,y:0,speed:300,destroyed:!1},this.spaceStation={x:this.sizes.canvas.width-this.sizes.spaceship,y:this.sizes.canvas.height-this.sizes.spaceship}}setAsteroids(e){const s=2*this.sizes.spaceship,t=this,i=this.asteroidSpeed;let a=n("width"),h=n("height");this.asteroids=[];for(let s,t=0;t<e;t++){s={x:a,y:h,dx:Math.random()>.5?i:-i,dy:Math.random()>.5?i:-i},this.asteroids.push(s),a=n("width"),h=n("height");for(let e=0;e<this.asteroids.length;)Math.abs(this.asteroids[e].x-a)<1.5*this.sizes.asteroid&&Math.abs(this.asteroids[e].y-h)<1.5*this.sizes.asteroid?(e=0,a=n("width"),h=n("height")):e++}function n(e){let i=s+Math.random()*(t.sizes.canvas[e]-2*s+1);return Math.floor(i)}}levelUp(){this.level++,this.resetStarship(),this.setAsteroids(this.level)}destroySpaceship(){this.spaceship.destroyed=!0,this.stopStarship()}spaceshipCoordsChange(e){const s=this.ssDirection,t=this.sizes,i=this.spaceship,a=i.speed;for(let h in s)if(s[h])switch(h){case"left":i.x>a*e?i.x-=a*e:i.x=0;break;case"up":i.y>a*e?i.y-=a*e:i.y=0;break;case"right":t.canvas.width-i.x>t.spaceship+a*e?i.x+=a*e:i.x=t.canvas.width-t.spaceship;break;case"down":t.canvas.height-i.y>t.spaceship+a*e?i.y+=a*e:i.y=t.canvas.height-t.spaceship}}asteroidsBouncing(e){const s=this.asteroids,t=this.sizes.asteroid;return s.forEach((i,a)=>{(i.x+i.dx*e>this.sizes.canvas.width-t||i.x+i.dx*e<0)&&(i.dx=-i.dx),(i.y+i.dy*e>this.sizes.canvas.height-t||i.y+i.dy*e<0)&&(i.dy=-i.dy);for(let h=a+1;h<s.length;h++)if(Math.abs(i.x+i.dx*e-s[h].x-s[h].dx*e)<t&&Math.abs(i.y+i.dy*e-s[h].y-s[h].dy*e)<t){Math.abs(i.x-s[h].x)>=t?(i.dx=-i.dx,s[h].dx=-s[h].dx):(i.dy=-i.dy,s[h].dy=-s[h].dy);break}s[a].x+=s[a].dx*e,s[a].y+=s[a].dy*e}),this}moveStarship(e){this.gameBegin||(this.gameBegin=!0);const s=this.ssDirection;switch(e){case"left":s.left=!0;break;case"up":s.up=!0;break;case"right":s.right=!0;break;case"down":s.down=!0}}stopMovingStarship(e){const s=this.ssDirection;switch(e){case"left":s.left=!1;break;case"up":s.up=!1;break;case"right":s.right=!1;break;case"down":s.down=!1}}resetStarship(){this.spaceship.x=this.spaceship.y=0,this.gameBegin=!1,this.stopStarship()}stopStarship(){for(let e in this.ssDirection)this.ssDirection[e]=!1}},new class{constructor(){this.canvas=document.getElementById("asteroidsCanvas"),this.ctx=this.canvas.getContext("2d"),this.spaceshipImg=new Image,this.spaceshipTransparentImg=new Image,this.asteroidImg=new Image,this.spaceStationImg=new Image,this.explosionImg=new Image,this.spaceshipImg.src="images/spaceship.png",this.spaceshipTransparentImg.src="images/transparent_spaceship.png",this.asteroidImg.src="images/asteroid.png",this.spaceStationImg.src="images/spacestation.png",this.explosionImg.src="images/explosion.png"}setCanvas(e){this.canvas.width=e.canvas.width,this.canvas.height=e.canvas.height,this.explosion=new i({img:this.explosionImg,pos:[0,0],size:[100,100],speed:10,frames:[0,1,2,3,4],once:!0,gameSize:e.spaceship})}drawAsteroid(e,s){this.ctx.drawImage(this.asteroidImg,e.x,e.y,s,s)}drawExplosion(e,s,t){this.explosion.render(this.ctx,s,t),this.explosion.update(e)}drawSpaceship(e,s,t){t&&!e.destroyed?this.ctx.drawImage(this.spaceshipImg,e.x,e.y,s,s):t||this.ctx.drawImage(this.spaceshipTransparentImg,e.x,e.y,s,s)}clearCanvas(){return this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height),this}drawSpaceStation(e,s){return this.ctx.drawImage(this.spaceStationImg,e.x,e.y,s,s),this}drawAll(e,s,t,i){this.clearCanvas().drawSpaceStation(e.spaceStation,s.spaceship).drawSpaceship(e.spaceship,s.spaceship,t),e.asteroids.forEach(e=>{this.drawAsteroid(e,s.asteroid)})}bind(e,s){document.addEventListener(e,s)}}),h=document.getElementById("startButton");a.lastTime=Date.now(),a.gameRender(),h.onclick=()=>{a.bindKeyHandlers(),a.bindButtonsTouch(),document.querySelector(".transparentBg").style.display="none",document.querySelector(".buttons").style.opacity="0"}}]);